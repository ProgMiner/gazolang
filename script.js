(()=>{"use strict";var r={911:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i},o=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.parseDefinition=void 0;var a=t(143),i=t(822),u=t(883),l=t(231);e.parseDefinition=function(r,e){var t=n((0,i.parseSpaces)(r,e),2),p=t[0],s=t[1],c=n((0,u.parseName)(p,s),2),f=c[0],y=c[1],v=i.parseSpaces.apply(void 0,o([],n(y),!1)),m=l.parseString.apply(void 0,o([":="],n(v),!1)),d=i.parseSpaces.apply(void 0,o([],n(m),!1)),h=n(a.parseExpr.apply(void 0,o([],n(d),!1)),2),b=h[0],x=h[1],E=i.parseSpaces.apply(void 0,o([],n(x),!1));return[{name:f,value:b,meta:s},l.parseString.apply(void 0,o([";"],n(E),!1))]}},249:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i},o=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.parseProgram=void 0;var a=t(911),i=t(635),u=t(822),l=t(143);e.parseProgram=function(r,e){var t=n((0,u.parseSpaces)(r,e),2),p=t[0],s=t[1],c=n((0,i.parseMany)(a.parseDefinition,p,s),2),f=c[0],y=c[1],v=n(l.parseExpr.apply(void 0,o([],n(y),!1)),2);return[{names:f,expr:v[0],meta:s},v[1]]}},752:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i};Object.defineProperty(e,"__esModule",{value:!0}),e.parseApplicationExpr=void 0;var o=t(148),a=t(143),i=t(822),u=t(758),l=t(635);e.parseApplicationExpr=function(r,e){var t=n((0,i.parseSpaces)(r,e),2),p=t[0],s=t[1],c=n((0,l.parseMany)(a.parseSimpleExpr,p,s),2),f=c[0],y=c[1];if(f.length<2)throw(0,u.parseError)(s);var v=(0,o.positionTo)(s,y[1]),m=f.reduce((function(r,e){return{type:a.ExprType.APPLICATION,function:r,argument:e,meta:v}}));if(m.type!==a.ExprType.APPLICATION)throw new Error("unreachable");return[m,y]}},143:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i},o=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.parseExpr=e.parseSimpleExpr=e.ExprType=void 0;var a,i=t(752),u=t(20),l=t(97),p=t(231),s=t(822),c=t(861);!function(r){r.STRING="string",r.NAME="name",r.APPLICATION="application",r.LAMBDA="lambda"}(a||(e.ExprType=a={})),e.parseSimpleExpr=function(r,t){try{return function(r,t){var a=n((0,s.parseSpaces)(r,t),2),i=a[0],u=a[1],l=(0,p.parseString)("(",i,u),c=n(e.parseExpr.apply(void 0,o([],n(l),!1)),2),f=c[0],y=c[1],v=s.parseSpaces.apply(void 0,o([],n(y),!1));return[f,p.parseString.apply(void 0,o([")"],n(v),!1))]}(r,t)}catch(e){try{return(0,l.parseStringExpr)(r,t)}catch(e){try{return(0,u.parseLambdaExpr)(r,t)}catch(e){return(0,c.parseNameExpr)(r,t)}}}},e.parseExpr=function(r,t){try{return(0,i.parseApplicationExpr)(r,t)}catch(n){return(0,e.parseSimpleExpr)(r,t)}}},20:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i};Object.defineProperty(e,"__esModule",{value:!0}),e.parseLambdaExpr=void 0;var o=t(148),a=t(143),i=t(822),u=t(231),l=t(883);e.parseLambdaExpr=function(r,e){var t=n((0,i.parseSpaces)(r,e),2),p=t[0],s=t[1],c=n((0,u.parseString)("\\",p,s),2),f=c[0],y=c[1],v=n((0,i.parseSpaces)(f,y),2),m=v[0],d=v[1],h=n((0,l.parseName)(m,d),2),b=h[0],x=n(h[1],2),E=x[0],S=x[1],g=n((0,i.parseSpaces)(E,S),2),_=g[0],w=g[1],P=n((0,u.parseString)("->",_,w),2),T=P[0],A=P[1],O=n((0,a.parseExpr)(T,A),2),M=O[0],j=O[1];return[{type:a.ExprType.LAMBDA,parameter:b,body:M,meta:(0,o.positionTo)(s,j[1])},j]}},861:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i};Object.defineProperty(e,"__esModule",{value:!0}),e.parseNameExpr=void 0;var o=t(148),a=t(822),i=t(883),u=t(143);e.parseNameExpr=function(r,e){var t=n((0,a.parseSpaces)(r,e),2),l=t[0],p=t[1],s=n((0,i.parseName)(l,p),2),c=s[0],f=s[1];return[{type:u.ExprType.NAME,name:c,meta:(0,o.positionTo)(p,f[1])},f]}},97:function(r,e,t){var n=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i};Object.defineProperty(e,"__esModule",{value:!0}),e.parseStringExpr=e.parseStringValue=void 0;var a=t(148),i=t(822),u=t(220),l=t(758),p=t(143);e.parseStringValue=function(r,e){var t,o,a=[],i=0,u=!1;try{for(var p=n(r.substring(1,r.length-1)),s=p.next();!s.done;s=p.next()){var c=s.value;if(++i,u){switch(c){case'"':a.push('"');break;case"n":a.push("\n");break;case"\\":a.push("\\");break;default:var f={row:e.row,column:e.column+i,fromStart:e.fromStart+i,length:1};throw(0,l.parseError)(f,'undefined control sequence "\\'.concat(c,'"'))}u=!1}else"\\"!==c?a.push(c):u=!0}}catch(r){t={error:r}}finally{try{s&&!s.done&&(o=p.return)&&o.call(p)}finally{if(t)throw t.error}}return a.join("")},e.parseStringExpr=function(r,t){var n=o((0,i.parseSpaces)(r,t),2),l=n[0],s=n[1],c=o((0,u.parseRegex)(/^"(?:\\.|[^"])*"/,l,s),2),f=c[0],y=c[1],v=(0,e.parseStringValue)(f,s);return[{type:p.ExprType.STRING,value:v,meta:(0,a.positionTo)(s,y[1])},y]}},25:function(r,e,t){var n=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateExpr=e.evaluate=e.lookupContext=e.expandContext=void 0;var o=t(143),a=t(758);e.expandContext=function(r,e){return{internalNames:{},names:e,previous:r}},e.lookupContext=function(r,t,n){if(r.names.hasOwnProperty(t))return r.names[t];if(r.internalNames.hasOwnProperty(t))return r.internalNames[t];if(void 0!==r.previous)return(0,e.lookupContext)(r.previous,t,n);throw(0,a.evalError)(n,'name "'.concat(t,"\" isn't present in context"))},e.evaluate=function(r,t){var o,i,u={};try{for(var l=n(t.names),p=l.next();!p.done;p=l.next()){var s=p.value,c=s.name,f=s.value,y=s.meta;if(c in u)throw(0,a.evalError)(y,"duplicated names are not supported");u[c]=(0,e.evaluateExpr)((0,e.expandContext)(r,u),f)}}catch(r){o={error:r}}finally{try{p&&!p.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return(0,e.evaluateExpr)((0,e.expandContext)(r,u),t.expr)},e.evaluateExpr=function(r,t){switch(t.type){case o.ExprType.STRING:return t.value;case o.ExprType.NAME:return(0,e.lookupContext)(r,t.name,t.meta);case o.ExprType.APPLICATION:var n=(0,e.evaluateExpr)(r,t.function),i=(0,e.evaluateExpr)(r,t.argument);if("function"!=typeof n)throw(0,a.evalError)(t.meta,"cannot apply value to non-function type");return n(i);case o.ExprType.LAMBDA:return function(n){var o;return(0,e.evaluateExpr)((0,e.expandContext)(r,((o={})[t.parameter]=n,o)),t.body)}}}},607:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i};Object.defineProperty(e,"__esModule",{value:!0});var o=t(148),a=t(758),i=t(25),u=t(249),l={internalNames:{show:function(r){return"".concat(r)},alert,prompt,confirm,true:!0,false:!1,if:function(r,e,t){if(!0===r)return e;if(!1===r)return t;throw new Error("condition must evaluate to boolean")},parseNumber:function(r){if("string"!=typeof r)throw new Error("argument of parseNumber must be string");return+r},"+":function(r){return function(e){if("number"!=typeof r||"number"!=typeof e)throw new Error("argument of + must be a number");return r+e}},"-":function(r){return function(e){if("number"!=typeof r||"number"!=typeof e)throw new Error("argument of - must be a number");return r-e}},"*":function(r){return function(e){if("number"!=typeof r||"number"!=typeof e)throw new Error("argument of * must be a number");return r*e}},"/":function(r){return function(e){if("number"!=typeof r||"number"!=typeof e)throw new Error("argument of / must be a number");return r/e}},"%":function(r){return function(e){if("number"!=typeof r||"number"!=typeof e)throw new Error("argument of % must be a number");return r%e}},asList:function(r){if("string"!=typeof r&&!Array.isArray(r))throw new Error("argument of asList must be string or list");for(var e=function(r){return function(r){return function(){return r}}},t=function(t){var n=e;e=function(e){return function(o){return function(){return e(r[t])(n(e)(o))}}}},n=r.length-1;n>=0;--n)t(n);return e}},names:{}};try{!function(){var r,e=document.getElementById("code"),t=document.getElementById("run");if(!(e instanceof HTMLTextAreaElement&&t instanceof HTMLButtonElement))throw Error("HTML elements not found");e.value=null!==(r=localStorage.getItem("code"))&&void 0!==r?r:"",e.onkeyup=function(){localStorage.setItem("code",e.value)},t.onclick=function(){try{var r=n((0,u.parseProgram)(e.value,(0,o.emptyPosition)()),2),t=r[0],p=n(r[1],2),s=p[0],c=p[1];if(""!==s.trim())throw(0,a.parseError)(c);alert((0,i.evaluate)(l,t))}catch(r){r instanceof Error&&alert(r.message),r instanceof a.PositionedError&&(e.focus({preventScroll:!0}),e.selectionStart=r.position.fromStart,(0,o.isPositionRange)(r.position)?e.selectionEnd=r.position.fromStart+r.position.length:e.selectionEnd=r.position.fromStart),console.error(r)}}}()}catch(r){console.error(r)}},148:function(r,e){var t=this&&this.__assign||function(){return t=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r},t.apply(this,arguments)},n=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.isPositionRange=e.positionTo=e.textToPosition=e.printPosition=e.sumPositions=e.emptyPosition=void 0,e.emptyPosition=function(){return{row:0,column:0,fromStart:0}},e.sumPositions=function(r,e){return{row:r.row+e.row,column:0===e.row?r.column+e.column:e.column,fromStart:r.fromStart+e.fromStart}},e.printPosition=function(r){var e=r.row,t=r.column;return"".concat(e,":").concat(t)},e.textToPosition=function(r){var e,t,o=0,a=0;try{for(var i=n(r),u=i.next();!u.done;u=i.next())"\n"!==u.value?++a:(++o,a=0)}catch(r){e={error:r}}finally{try{u&&!u.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return{row:o,column:a,fromStart:r.length}},e.positionTo=function(r,e){return t(t({},r),{length:e.fromStart-r.fromStart})},e.isPositionRange=function(r){return"length"in r}},758:function(r,e,t){var n,o=this&&this.__extends||(n=function(r,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},n(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.evalError=e.parseError=e.PositionedError=void 0;var a=t(148),i=function(r){function e(t,n){var o=r.call(this,"".concat(t," on ").concat((0,a.printPosition)(n)))||this;return o.position=n,Object.setPrototypeOf(o,e.prototype),o}return o(e,r),e}(Error);e.PositionedError=i,e.parseError=function(r,e){return void 0===e&&(e="parsing error"),new i(e,r)},e.evalError=function(r,e){return void 0===e&&(e="evaluation error"),new i(e,r)}},635:function(r,e){var t=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,a=t.call(r),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i},n=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.parseMany=void 0,e.parseMany=function(r,e,o){for(var a=[],i=[e,o];;)try{var u=t(r.apply(void 0,n([],t(i),!1)),2),l=u[0],p=u[1];a.push(l),i=p}catch(r){break}return[a,i]}},883:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseName=void 0;var n=t(220);e.parseName=function(r,e){return(0,n.parseRegex)(/^[^;()\s]+/u,r,e)}},220:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseRegex=void 0;var n=t(148),o=t(758);e.parseRegex=function(r,e,t){var a=e.match(r);if(null===a)throw(0,o.parseError)(t);var i=a[0];return[i,[e.substring(i.length),(0,n.sumPositions)(t,(0,n.textToPosition)(i))]]}},822:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseSpaces=void 0;var n=t(148);e.parseSpaces=function(r,e){var t=r.match(/^\s*/);return null===t?[r,e]:[r.substring(t[0].length),(0,n.sumPositions)(e,(0,n.textToPosition)(t[0]))]}},231:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseString=void 0;var n=t(148),o=t(758);e.parseString=function(r,e,t){if(!e.startsWith(r))throw(0,o.parseError)(t);return[e.substring(r.length),(0,n.sumPositions)(t,(0,n.textToPosition)(r))]}}},e={};!function t(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return r[n].call(a.exports,a,a.exports,t),a.exports}(607)})();